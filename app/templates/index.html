{% extends "base.html" %} {% block title %}TechSisters Book Club - Home{%
endblock %} {% block content %}
<!-- Hero Section -->
<div class="gradient-bg text-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
    <div class="text-center">
      <h1 class="text-5xl font-bold mb-6">
        Welcome to TechSisters Book Club üìö
      </h1>
      <p class="text-xl mb-8 opacity-90 max-w-2xl mx-auto">
        A community of tech women reading together, growing together, and
        learning together.
      </p>
      <button
        onclick="document.getElementById('code-modal').classList.remove('hidden')"
        class="bg-white text-purple-600 px-8 py-4 rounded-lg text-lg font-semibold hover:shadow-xl transition-all transform hover:scale-105"
      >
        üîì Enter Access Code
      </button>
      <p class="mt-4 text-sm opacity-75">
        This platform is for TechSisters members only. Get the code from the
        TechSisters Book Club WhatsApp group.
      </p>
    </div>
  </div>
</div>

<!-- Features Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
  <div class="grid md:grid-cols-3 gap-8">
    <div class="card-hover bg-white p-6 rounded-xl shadow-sm border">
      <div class="text-4xl mb-4">üìñ</div>
      <h3 class="text-xl font-semibold mb-2">Read Together</h3>
      <p class="text-gray-600">
        Join us in reading curated books on technology, career growth, and
        personal development.
      </p>
    </div>

    <div class="card-hover bg-white p-6 rounded-xl shadow-sm border">
      <div class="text-4xl mb-4">üí¨</div>
      <h3 class="text-xl font-semibold mb-2">Discuss</h3>
      <p class="text-gray-600">
        Engage in meaningful discussions during our bi-weekly meetings on Google
        Meet.
      </p>
    </div>

    <div class="card-hover bg-white p-6 rounded-xl shadow-sm border">
      <div class="text-4xl mb-4">üå±</div>
      <h3 class="text-xl font-semibold mb-2">Grow</h3>
      <p class="text-gray-600">
        Track your progress, suggest books, and be part of a supportive
        community.
      </p>
    </div>
  </div>
</div>

<!-- How It Works -->
<div class="bg-gray-100 py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl font-bold text-center mb-12">How It Works</h2>
    <div class="grid md:grid-cols-4 gap-6">
      <!-- Step 1 -->
      <div class="text-center">
        <div
          class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <span class="text-2xl font-bold text-purple-600">1</span>
        </div>
        <h3 class="font-semibold mb-2">Join TechSisters</h3>
        <p class="text-sm text-gray-600">
          Become part of the TechSisters community and join the TechSisters
          WhatsApp space.
        </p>
      </div>

      <!-- Step 2 -->
      <div class="text-center">
        <div
          class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <span class="text-2xl font-bold text-purple-600">2</span>
        </div>
        <h3 class="font-semibold mb-2">Enter the Book Club</h3>
        <p class="text-sm text-gray-600">
          From the TechSisters WhatsApp space, join the Book Club group to
          receive the access code.
        </p>
      </div>

      <!-- Step 3 -->
      <div class="text-center">
        <div
          class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <span class="text-2xl font-bold text-purple-600">3</span>
        </div>
        <h3 class="font-semibold mb-2">Use the Code Here</h3>
        <p class="text-sm text-gray-600">
          Enter the code on this site to see our current book, schedule, and
          archive.
        </p>
      </div>

      <!-- Step 4 -->
      <div class="text-center">
        <div
          class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
        >
          <span class="text-2xl font-bold text-purple-600">4</span>
        </div>
        <h3 class="font-semibold mb-2">Read & Discuss</h3>
        <p class="text-sm text-gray-600">
          Read along, track your progress here, and discuss everything in the
          WhatsApp group.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- CTA Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center">
  <h2 class="text-3xl font-bold mb-4">Not in Our WhatsApp Group Yet?</h2>
  <p class="text-gray-600 mb-8">
    Join TechSisters to access our book club and other amazing resources!
  </p>
  <a
    href="https://chat.whatsapp.com/YOUR_GROUP_LINK"
    target="_blank"
    class="inline-block bg-green-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-600 transition-all"
  >
    üíö Join TechSisters WhatsApp
  </a>
</div>

<!-- Code Verification Modal -->
<div
  id="code-modal"
  class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
>
  <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl">
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-2xl font-bold">Enter Access Code</h3>
      <button
        onclick="document.getElementById('code-modal').classList.add('hidden')"
        class="text-gray-400 hover:text-gray-600 text-2xl"
      >
        √ó
      </button>
    </div>

    <form
      hx-post="/auth/verify-code"
      hx-target="#code-result"
      hx-swap="innerHTML"
      hx-preserve="true"
      class="space-y-4"
    >
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Access Code
        </label>
        <input
          type="text"
          name="code"
          id="code-input"
          placeholder="Enter code from WhatsApp"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all"
          required
          autocomplete="off"
          autocapitalize="characters"
        />
        <p class="text-xs text-gray-500 mt-1">
          Enter the code shared in the WhatsApp group
        </p>
      </div>

      <!-- Empty div for HTMX to target, but we'll handle everything via toasts -->
      <div id="code-result" class="min-h-6"></div>

      <div class="space-y-2">
        <button
          type="submit"
          class="w-full btn-primary text-white py-3 rounded-lg font-semibold transition-all hover:shadow-lg"
          id="verify-btn"
        >
          üîì Verify Code
        </button>

        <button
          type="button"
          onclick="document.getElementById('code-modal').classList.add('hidden')"
          class="w-full bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-all"
        >
          Cancel
        </button>
      </div>
    </form>

    <div class="mt-4 text-center">
      <p class="text-sm text-gray-600">
        Don't have the code?
        <a
          href="https://chat.whatsapp.com/YOURGROUPLINK"
          target="_blank"
          class="text-purple-600 hover:text-purple-800 font-medium"
        >
          Join the TechSisters WhatsApp community
        </a>
        and then the Book Club group to receive it.
      </p>
    </div>
  </div>
</div>

<script>
  // Handle code verification form submission
  document.addEventListener("htmx:afterSwap", function (event) {
    if (event.detail.target.id === "code-result") {
      const response = event.detail.xhr.response;
      try {
        const data = JSON.parse(response);
        if (data.success) {
          showToast("‚úÖ Code verified! Redirecting...", "success");
          setTimeout(() => {
            window.location.href = "/dashboard";
          }, 1000);
        } else {
          // Clear the result div (we don't need it)
          event.detail.target.innerHTML = "";

          // Show error toast
          showToast(`‚ùå ${data.detail || "Invalid code"}`, "error");

          // Shake animation for error
          const codeInput = document.getElementById("code-input");
          if (codeInput) {
            codeInput.classList.add("animate-shake");
            setTimeout(() => {
              codeInput.classList.remove("animate-shake");
            }, 500);
          }
        }
      } catch (e) {
        // Clear the result div
        event.detail.target.innerHTML = "";
        showToast("üö® An error occurred. Please try again.", "error");
      }
    }
  });

  // Handle HTTP errors for the verify-code form
  document.addEventListener("htmx:responseError", function (event) {
    if (event.detail.requestConfig.path === "/auth/verify-code") {
      try {
        const response = JSON.parse(event.detail.xhr.response);

        // Clear any content in result div
        const errorDiv = document.getElementById("code-result");
        if (errorDiv) {
          errorDiv.innerHTML = "";
        }

        // Show error toast
        showToast(`‚ùå ${response.detail || "Invalid code"}`, "error");

        // Shake animation for error
        const codeInput = document.getElementById("code-input");
        if (codeInput) {
          codeInput.classList.add("animate-shake");
          setTimeout(() => {
            codeInput.classList.remove("animate-shake");
          }, 500);
        }
      } catch (e) {
        showToast("üö® An error occurred. Please try again.", "error");
      }
    }
  });

  // Add shake animation CSS
  const style = document.createElement("style");
  style.textContent = `
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    .animate-shake {
        animation: shake 0.5s ease-in-out;
    }
`;
  document.head.appendChild(style);

  // Add loading state to verify button
  document.addEventListener("htmx:beforeRequest", function (event) {
    if (event.detail.requestConfig.path === "/auth/verify-code") {
      const verifyBtn = document.getElementById("verify-btn");
      if (verifyBtn) {
        verifyBtn.innerHTML = "‚è≥ Verifying...";
        verifyBtn.disabled = true;
      }
    }
  });

  // Restore button after request
  document.addEventListener("htmx:afterRequest", function (event) {
    if (event.detail.requestConfig.path === "/auth/verify-code") {
      const verifyBtn = document.getElementById("verify-btn");
      if (verifyBtn) {
        verifyBtn.innerHTML = "üîì Verify Code";
        verifyBtn.disabled = false;
      }
    }
  });
</script>
{% endblock %}
